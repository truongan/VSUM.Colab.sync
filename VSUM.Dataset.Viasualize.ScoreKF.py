
import h5py
import matplotlib.pyplot as plt
import numpy as np
import cv2
from vsum_tools import *

from get_predict_score_for_video_id import get_score

# Ánh xạ videoID - videoName
file_name_to_h5 = {'0tmA_C6XwfM.mp4': 'video_13', 'EE-bNr36nyA.mp4': 'video_38', 'JgHubY5Vw3Y.mp4': 'video_44', 'VuWGsYPqAX8.mp4': 'video_31', '37rzWOQsNIw.mp4': 'video_19', 'eQu1rNs0an0.mp4': 'video_43', 'JKpqYvAdIsw.mp4': 'video_32', '3eYKfiOEJNs.mp4': 'video_14', '-esJrBWj2d8.mp4': 'video_50', 'kLxoNp-UchI.mp4': 'video_48', 'WxtbjNsCQ8A.mp4': 'video_36', '4wU_LUjG5Ic.mp4': 'video_30', 'EYqVtI9YWJA.mp4': 'video_42', 'LRw_obCPUt0.mp4': 'video_20', 'XkqCExn6_Us.mp4': 'video_23', '91IHQYk1IQM.mp4': 'video_26', 'fWutDQy1nnY.mp4': 'video_29', 'NyBmCxDoHJU.mp4': 'video_47', 'xmEERLqJ2kU.mp4': 'video_33', '98MoyGZKHXc.mp4': 'video_2', 'GsAD1KT1xo8.mp4': 'video_24', 'oDXZc0tZe04.mp4': 'video_40', '_xMr-HKMfVA.mp4': 'video_35', 'akI8YFjEmUw.mp4': 'video_10', 'gzDbaEs1Rlg.mp4': 'video_4', 'PJrm840pAUI.mp4': 'video_25', 'xwqBXPGE9pQ.mp4': 'video_9', 'AwmHb44_ouw.mp4': 'video_1', 'Hl-__g2gn_A.mp4': 'video_17', 'qqR6AEXwxoQ.mp4': 'video_41', 'xxdtq8mxegs.mp4': 'video_15', 'b626MiF1ew4.mp4': 'video_22', 'HT5vyqe0Xaw.mp4': 'video_6', 'RBCABdttQmI.mp4': 'video_27', 'XzYM3PfTM4w.mp4': 'video_5', 'Bhxk-O1Y7Ho.mp4': 'video_12', 'i3wAGJaaktw.mp4': 'video_11', 'Yi4Ij2NM7U4.mp4': 'video_18', 'byxOvuiIJV0.mp4': 'video_34', 'iVt07TCkFM0.mp4': 'video_45', 'sTEELN-vY30.mp4': 'video_7', 'z_6gVvQb2d0.mp4': 'video_28', 'cjibtmSLxQ4.mp4': 'video_21', 'J0nA4VgnoCo.mp4': 'video_3', 'uGu_10sucQo.mp4': 'video_37', 'E11zDS9XGzg.mp4': 'video_46', 'jcoYJXDG9sw.mp4': 'video_49', 'vdmoEJ5YbrQ.mp4': 'video_8', 'WG0MBPpPC6I.mp4': 'video_16', 'Se3oxnaPsz0.mp4': 'video_39'}
h5_to_file_name = {'video_13': '0tmA_C6XwfM.mp4', 'video_38': 'EE-bNr36nyA.mp4', 'video_44': 'JgHubY5Vw3Y.mp4', 'video_31': 'VuWGsYPqAX8.mp4', 'video_19': '37rzWOQsNIw.mp4', 'video_43': 'eQu1rNs0an0.mp4', 'video_32': 'JKpqYvAdIsw.mp4', 'video_14': '3eYKfiOEJNs.mp4', 'video_50': '-esJrBWj2d8.mp4', 'video_48': 'kLxoNp-UchI.mp4', 'video_36': 'WxtbjNsCQ8A.mp4', 'video_30': '4wU_LUjG5Ic.mp4', 'video_42': 'EYqVtI9YWJA.mp4', 'video_20': 'LRw_obCPUt0.mp4', 'video_23': 'XkqCExn6_Us.mp4', 'video_26': '91IHQYk1IQM.mp4', 'video_29': 'fWutDQy1nnY.mp4', 'video_47': 'NyBmCxDoHJU.mp4', 'video_33': 'xmEERLqJ2kU.mp4', 'video_2': '98MoyGZKHXc.mp4', 'video_24': 'GsAD1KT1xo8.mp4', 'video_40': 'oDXZc0tZe04.mp4', 'video_35': '_xMr-HKMfVA.mp4', 'video_10': 'akI8YFjEmUw.mp4', 'video_4': 'gzDbaEs1Rlg.mp4', 'video_25': 'PJrm840pAUI.mp4', 'video_9': 'xwqBXPGE9pQ.mp4', 'video_1': 'AwmHb44_ouw.mp4', 'video_17': 'Hl-__g2gn_A.mp4', 'video_41': 'qqR6AEXwxoQ.mp4', 'video_15': 'xxdtq8mxegs.mp4', 'video_22': 'b626MiF1ew4.mp4', 'video_6': 'HT5vyqe0Xaw.mp4', 'video_27': 'RBCABdttQmI.mp4', 'video_5': 'XzYM3PfTM4w.mp4', 'video_12': 'Bhxk-O1Y7Ho.mp4', 'video_11': 'i3wAGJaaktw.mp4', 'video_18': 'Yi4Ij2NM7U4.mp4', 'video_34': 'byxOvuiIJV0.mp4', 'video_45': 'iVt07TCkFM0.mp4', 'video_7': 'sTEELN-vY30.mp4', 'video_28': 'z_6gVvQb2d0.mp4', 'video_21': 'cjibtmSLxQ4.mp4', 'video_3': 'J0nA4VgnoCo.mp4', 'video_37': 'uGu_10sucQo.mp4', 'video_46': 'E11zDS9XGzg.mp4', 'video_49': 'jcoYJXDG9sw.mp4', 'video_8': 'vdmoEJ5YbrQ.mp4', 'video_16': 'WG0MBPpPC6I.mp4', 'video_39': 'Se3oxnaPsz0.mp4'}

szRootDir = '/gdrive/MyDrive/VSum/Colab/' #An
video_dir = '/mnt/3TiB/tvsum/ydata-tvsum50-video/video/'
h5_file = 'VSUM0623/datasets/TVSum/eccv16_dataset_tvsum_google_pool5.h5'


h5_video_id = 'video_18'
video_file_path = f'{video_dir}/{h5_to_file_name[h5_video_id]}'

h5data = h5py.File(h5_file, 'r')



picks = h5data[h5_video_id]['picks'][...]
# print(picks)
# print(len(picks))
# print(h5data[h5_video_id]['gtscore'][...])
# print(len(h5data[h5_video_id]['gtscore'][...]))
# print(h5data[h5_video_id]['change_points'][...])

image_size = max(80, 2560 // len(picks))

frame_count  = 0
pick_index = 0
# vid = cv2.VideoCapture(video_file_path)
# got, frame = vid.read()

# hacs_score = [0.54434943, 0.57348275, 0.5906159, 0.095270544, 0.009712099, 0.37657252, 0.5084772, 0.49746075, 0.49312705, 0.53873205, 0.5519097, 0.57500523, 0.58296764, 0.56456125, 0.5788429, 0.5847407, 0.578054, 0.5737755, 0.5776574, 0.5831232, 0.5815527, 0.61003596, 0.6193264, 0.6216871, 0.6265125, 0.6182904, 0.61724913, 0.6232108, 0.61933005, 0.6197895, 0.61748177, 0.61726534, 0.6204795, 0.60866165, 0.5994543, 0.61550885, 0.6144709, 0.61400235, 0.6131063, 0.60881966, 0.61456347, 0.62709105, 0.6259743, 0.62708205, 0.61590594, 0.62116987, 0.62176055, 0.6252223, 0.6247647, 0.6303177, 0.63320756, 0.62870353, 0.62970614, 0.62188315, 0.62546015, 0.6310482, 0.62062955, 0.6234814, 0.626885, 0.63224626, 0.62712055, 0.62473553, 0.61947846, 0.619207, 0.62050486, 0.6198331, 0.6189727, 0.61983716, 0.6153199, 0.6168898, 0.61846834, 0.6174882, 0.62053686, 0.6237151, 0.3704915, 0.49519926, 0.46896848, 0.12213814, 0.09377657, 0.011529362, 0.2303691, 0.4499573, 0.107311636, 0.61180806, 0.17370032, 0.27373362, 0.46622244, 0.61159825, 0.6100494, 0.60112506, 0.60861254, 0.59349054, 0.6260653, 0.60928684, 0.62528634, 0.5892832, 0.61582065, 0.6062418, 0.5305498, 0.21309772, 0.16057855, 0.12160381, 0.40713245, 0.63858247, 0.62402016, 0.6429204, 0.6291729, 0.62458044, 0.63755345, 0.64181656, 0.64268464, 0.64356655, 0.64364684, 0.63384885, 0.6285055, 0.6359291, 0.63888586, 0.6396432, 0.6303608, 0.64111525, 0.6368693, 0.6334865, 0.64122224, 0.6374615, 0.6361144, 0.6364851, 0.6280333, 0.6319609, 0.63020027, 0.6358757, 0.6368032, 0.626598, 0.60181624, 0.6038261, 0.60328466, 0.6058789, 0.60372555, 0.60444, 0.6042595, 0.60041475, 0.5945351, 0.6089921, 0.60277945, 0.60415715, 0.6114834, 0.5808596, 0.61610883, 0.5532377, 0.5966722, 0.60312927, 0.6012119, 0.5999709, 0.5793364, 0.5537567, 0.27800968, 0.5778627, 0.3931934, 0.16184734, 0.6172013, 0.58646476, 0.59052444, 0.5920377, 0.59777105, 0.59221756, 0.5963205, 0.60865664, 0.6310044, 0.6268754, 0.62619394, 0.62642235, 0.6298594, 0.6143113, 0.59166557, 0.5958931, 0.5972336, 0.59628433, 0.5954238, 0.5964826, 0.5952807, 0.59462094, 0.61573344, 0.15994719, 0.103847854, 0.12688355, 0.15513784, 0.15441078, 0.1579066, 0.22130613, 0.21999818, 0.113068916, 0.09822446, 0.09772301, 0.103409044, 0.102899306, 0.106964946, 0.088407926, 0.3258667]
hacs_score = [0.009230981, 0.016346246, 0.008927351, 0.033966716, 0.01988011, 0.06099226, 0.0766301, 0.104206115, 0.10238395, 0.00982562, 0.0051739, 0.012237632, 0.018201355, 0.011509066, 0.017488865, 0.017791394, 0.047341738, 0.42713976, 0.26814455, 0.06711128, 0.09494773, 0.18735127, 0.021164754, 0.20623705, 0.008656188, 0.031778164, 0.27346405, 0.008386403, 0.023137806, 0.019319132, 0.0068508824, 0.04457797, 0.10306581, 0.029145164, 0.06574905, 0.21643488, 0.11315025, 0.6071026, 0.0055236225, 0.015031484, 0.016811281, 0.03206769, 0.11938443, 0.012744624, 0.31293452, 0.041838177, 0.06280404, 0.03839914, 0.32602936, 0.4588043, 0.12342978, 0.028735185, 0.006234257, 0.017057681, 0.115683496, 0.16929403, 0.025423935, 0.031216329, 0.0074897385, 0.58470994, 0.35908583, 0.1201914, 0.0020313226, 0.002566083, 0.0028857833, 0.0064634527, 0.026408508, 0.072209425, 0.040595423, 0.01439304, 0.003070075, 0.0073632738, 0.008568836, 0.006597705, 0.001767808, 0.007047476, 0.004674243, 0.022748457, 0.014945542, 0.0041376897, 0.0055896225, 0.00759518, 0.6011417, 0.62294227, 0.6226348, 0.62166274, 0.6245898, 0.6247826, 0.6222487, 0.61874205, 0.61860687, 0.61840445, 0.61923766, 0.61374617, 0.6187156, 0.6316703, 0.6219679, 0.61767876, 0.61197525, 0.6118766, 0.6161433, 0.0042181327, 3.573035e-05, 5.8704743e-05, 0.0014289853, 0.00045529788, 0.00036285372, 0.40485364, 0.5540255, 0.13645773, 0.49581882, 0.15693717, 0.5677055, 0.018109148, 0.08168029, 0.014175657, 0.42726856, 0.24344963, 0.2704544, 0.38371068, 0.21516839, 0.36500502, 0.31428894, 0.28281683, 0.3741551, 0.5833947, 0.46476626, 0.060526356, 0.39422396, 0.0031780242, 0.5804656, 0.0008972945, 0.3318621, 0.0015087397, 4.955011e-05, 0.62582177, 0.62388706, 0.6328247, 0.6300299, 0.65142184, 0.63796043, 0.63568795, 0.62613195, 0.6350619, 0.6330516, 0.6361846, 0.6385027, 0.6381032, 0.6314999, 0.634019, 0.65633863, 0.6351334, 0.64211804, 0.6227334, 0.6289286, 0.63166475, 0.0062528336, 0.0063928505, 0.47509623, 0.6261674, 0.61960053, 0.62869114, 0.6349631, 0.49267074, 0.601108, 0.3762301, 0.62398624, 0.62719256, 0.63931483, 0.6335404, 0.63918656, 0.6300763, 0.6356111, 0.6378057, 0.021640673, 0.651614, 0.58687645, 0.5657205, 0.54797584, 0.6181329, 0.6276849, 0.52997893, 0.2319058, 0.5549088, 0.6014103, 0.24706146, 0.027562473, 0.0012203825, 0.15746151, 0.042522106, 0.62475395, 0.6360499, 0.63499975, 0.63865525, 0.64303046, 0.6442874, 0.62168604, 0.6438599, 0.5957621, 0.6429998, 0.6397641, 0.6354024, 0.6466226, 0.63551044, 0.6457217, 0.65381813, 0.62776226, 0.6396004, 0.6481217, 0.64706486, 0.6488759, 0.64790976, 0.6363033, 0.63297224, 0.6385377, 0.63623756, 0.64338857, 0.64167136, 0.64763886, 0.6468889, 0.6480715, 0.63331574, 0.6326208, 0.6629145, 0.65262896, 0.64009184, 0.6515039, 0.63022155, 0.6402082, 0.645663, 0.6475623, 0.6382313, 0.63925254, 0.63986206, 0.63143694, 0.63485044, 0.63692605, 0.6293722, 0.6133632, 0.63186145, 0.6339574, 0.6356062, 0.62895507, 0.6293397, 0.6365778, 0.62755275, 0.6292934, 0.637067, 0.5999152, 0.6260617, 0.62661153, 0.63576263, 0.6365375, 0.63416797, 0.6296458, 0.6294112, 0.6329358, 0.64035565, 0.6205838, 0.62802607, 0.62754506, 0.63212717, 0.63196486, 0.6316513, 0.63773423, 0.59659994, 0.64086527, 0.6363005, 0.6260328, 0.630612, 0.62428343, 0.6529185, 0.62179863, 0.6283446, 0.6250354, 0.63244855, 0.63150144, 0.6327475, 0.626507, 0.6283703, 0.63956314, 0.6450129, 0.64345515, 0.637651, 0.63304603, 0.6361087, 0.6311077, 0.6338844, 0.009267273, 0.000105852865, 1.3131026e-05, 0.00044212808, 0.00088219775, 0.6328866, 0.62181437, 0.0055265096, 7.238551e-05, 7.4244694e-05, 0.00013073027, 0.5754292, 0.5522311, 0.06011064, 0.65826935, 0.3303216, 0.00013604257, 6.443852e-05, 5.1922154e-05, 6.880433e-05, 6.217144e-05, 0.0046806317, 8.492334e-06, 1.5900476e-05, 9.198459e-05, 0.00045047727, 3.223236e-05, 0.6162032, 0.60451525, 7.069453e-05, 0.00010378946, 0.11321201, 0.47597283, 0.5842864, 0.045279626, 0.007899391, 0.0054064714, 0.07356801, 0.08777962, 0.19944741, 0.35580173, 0.08174692, 0.4781207, 0.43673706, 0.284686, 0.0034119196, 3.955442e-05, 7.4432195e-05, 0.3341709, 0.46285397, 1.6335183e-05, 9.438914e-05, 3.7211754e-05, 2.4938865e-05, 9.063595e-05, 1.7373113e-05, 6.962341e-05, 6.448364e-05, 0.2779251, 0.3265786, 0.21466534, 0.201344, 0.19260788, 0.254719, 0.1984011, 0.16931489, 0.22772963, 0.2211588, 0.18324837, 0.1546228, 0.1881529, 0.2976993, 0.30157435, 0.26355147, 0.21180448, 0.12392804, 0.28457242, 0.5042161, 0.333239, 0.24219546, 0.26803756, 0.3697128, 0.26708713, 0.10260951, 0.10673513, 0.2684558, 0.32337406, 0.29377857, 0.49653128, 0.29880524, 0.47635317, 0.42407787, 0.6048675, 0.6091785, 0.673273, 0.56212795, 0.5612579, 0.26838937, 0.60675484, 0.6318563, 0.73664993, 0.48487017, 0.3080663, 0.4827746, 0.70674753, 0.62959224, 0.62929, 0.6275873, 0.6496554, 0.5761208, 0.62362444, 0.41619945, 0.4896656, 0.3956374, 0.45794544, 0.5034378, 0.5231337, 0.4947175, 0.5576455, 0.6174747, 0.6296001, 0.5007062, 0.64058024, 0.5571308, 0.4775769, 0.50421333, 0.6281502, 0.6341117, 0.6496529, 0.62419313, 0.6593783, 0.65111274, 0.6565168, 0.6669529, 0.669588, 0.62455106, 0.62677777, 0.634792, 0.62689453, 0.5730094, 0.5887524, 0.55898845, 0.6615612, 0.6449154, 0.5213198, 0.009415378, 0.25411016, 0.10176519, 0.09121293, 0.06568994, 0.039387617, 0.06352629, 0.03135008, 0.032672856, 0.007352763, 0.0060247583, 0.009317466, 0.0043187723, 0.053588443, 0.20084053, 0.08199003, 0.45404527, 0.46533474, 0.3752231, 0.34623587, 0.38692492, 0.4495923, 0.4348376, 0.29009733, 0.07573459, 0.016312582, 0.08596371, 0.012153723, 0.33791238, 0.01271845, 0.039573736, 0.14255573, 0.61997604, 0.6309381, 0.5551133, 0.641645, 0.50468427, 0.42538753, 0.5216004, 0.58276504, 0.4856161, 0.57447416, 0.59055305, 0.5870074, 0.53260845, 0.59956986, 0.6397133, 0.5681006, 0.6663345, 0.6414184, 0.58247226, 0.53235364, 0.58986664, 0.6214598, 0.59331363, 0.5933409, 0.5675665, 0.45357767, 0.5365445, 0.009101321, 0.009364862, 0.02004245, 0.0044414606, 0.0045941668, 0.110597804, 0.18434148, 0.044600114, 0.010842504, 0.049976137, 0.016737647, 0.010696936, 0.019521965, 0.6196412, 0.008099401, 0.4926452, 0.004172948, 0.042602487, 0.0051091076, 0.1749147, 0.51954573, 0.008550679, 0.0010814639, 0.11519445, 0.01024853, 0.06137772, 0.22260226, 0.5568291, 0.072119065, 0.016480645, 0.11808129, 0.16168988, 0.58539486, 0.59254724, 0.6421105, 0.60445726, 0.5610009, 0.53557616, 0.49958834, 0.5864952, 0.52530575, 0.42117828, 0.59822804, 0.5355665, 0.66161263, 0.20027153, 0.63255244, 0.63084316, 0.5423488, 0.5768453, 0.62920946, 0.61027145, 0.6358754, 0.5363428, 0.6875636, 0.61764985, 0.000689305, 0.018026209, 0.024373852, 0.46461177, 0.4470833, 0.30292973, 0.26919365, 0.3049689, 0.26024675, 0.37120792, 0.49308527, 0.2822053, 0.4102022, 0.44495317, 0.29399362, 0.36256868, 0.47130346, 0.5372332, 0.6103348, 0.5897438, 0.6170793, 0.60263896, 0.5925844, 0.6069171, 0.58517754, 0.6262867, 0.5974994, 0.5155424, 0.6087373, 0.6024783, 0.58325946, 0.54720646, 0.60274976, 0.6159305, 0.6128282, 0.61126405, 0.60110146, 0.52772313, 0.51406235, 0.50182354, 0.046877638, 0.016398994, 0.3678832, 0.6370892, 0.5969969, 0.59482104, 0.6014143, 0.59935075, 0.59598625, 0.59471494, 0.595981, 0.63139427, 0.61750394, 0.00063358207, 0.00039304898, 0.5966766, 0.59877276, 0.6137256, 0.61075795, 0.6322847, 0.62898046, 0.62792915, 0.61461407, 0.0003305111, 0.00043224893, 7.7857665e-05, 0.004765866, 0.1956214, 0.51180255, 0.63455504, 0.61693573, 0.6443735, 0.09023181, 0.0028511197, 0.00028361985, 0.0004784534, 0.606054, 0.0087209055, 0.0008180614, 0.012207811, 0.057493057, 0.13597232, 0.000113396134, 0.0017430693, 0.0011219153, 0.0022633376, 0.00054159976, 0.00017819433, 0.00060487684, 0.0011042004, 0.00015107478, 0.001662583, 0.5672019, 0.45333436, 0.44349557, 0.45201606, 0.4636776, 0.47110304, 0.43124452, 0.4882589, 0.5749479]
original_vasnet_googlenet_score = [0.16719097, 0.10025385, 0.15904678, 0.16443603, 0.18514487, 0.35959348, 0.14618245, 0.18839471, 0.19221865, 0.16133259, 0.14581493, 0.14933573, 0.17174791, 0.1828744, 0.15935864, 0.18724108, 0.15894853, 0.15275675, 0.20430775, 0.17090175, 0.20559552, 0.19155493, 0.20918278, 0.18319751, 0.15815288, 0.16254947, 0.19606985, 0.16736183, 0.18879884, 0.19249514, 0.18525045, 0.20169224, 0.1980642, 0.20610479, 0.18456648, 0.1949619, 0.17263669, 0.15260817, 0.15928057, 0.18108156, 0.15458332, 0.16310868, 0.16810615, 0.20510991, 0.16653885, 0.17388272, 0.190479, 0.18923207, 0.20958093, 0.18359894, 0.18720971, 0.17693584, 0.16676903, 0.17672093, 0.15500051, 0.1966438, 0.20389657, 0.19150196, 0.15747951, 0.2570241, 0.14738676, 0.20116644, 0.16588116, 0.18415058, 0.1771258, 0.17946032, 0.16877612, 0.16668266, 0.18004614, 0.20332009, 0.15453833, 0.17464174, 0.16030508, 0.16984148, 0.17016436, 0.15322924, 0.1547718, 0.1579022, 0.18336968, 0.1939098, 0.17592417, 0.14788823, 0.48305258, 0.41403094, 0.4586479, 0.40039125, 0.35796392, 0.4364189, 0.46350408, 0.4377507, 0.44833678, 0.4374856, 0.43980277, 0.44544122, 0.4692814, 0.42150488, 0.44498196, 0.41614187, 0.38645887, 0.39432225, 0.15204138, 0.18905649, 0.15731324, 0.17294396, 0.17629057, 0.1681902, 0.1721126, 0.263664, 0.24136345, 0.23868519, 0.2980167, 0.18694404, 0.22338912, 0.17005658, 0.15327178, 0.1640432, 0.29098755, 0.18892948, 0.32725248, 0.23115501, 0.28370187, 0.26418477, 0.21327588, 0.3481424, 0.31328994, 0.25622123, 0.17785777, 0.1782168, 0.2467255, 0.1700057, 0.24236692, 0.20609105, 0.18645142, 0.18853526, 0.16949785, 0.4831391, 0.453299, 0.40531698, 0.4061583, 0.5407786, 0.48952156, 0.48418027, 0.41088265, 0.3471956, 0.34938726, 0.44634506, 0.43862385, 0.48643565, 0.4248553, 0.44820258, 0.46432927, 0.4495126, 0.49439287, 0.50039756, 0.4323587, 0.4162947, 0.15175352, 0.12996602, 0.21398942, 0.21636523, 0.20333742, 0.18024254, 0.16527922, 0.15656386, 0.19993775, 0.16838615, 0.20935346, 0.21435702, 0.23567748, 0.14534892, 0.210974, 0.26786858, 0.20371045, 0.30935895, 0.20536806, 0.23502594, 0.21136785, 0.23548287, 0.21670681, 0.19594885, 0.21963808, 0.20430306, 0.16243717, 0.1800762, 0.16699055, 0.1834568, 0.15079175, 0.16100515, 0.19790164, 0.16827361, 0.35467696, 0.3814452, 0.31794629, 0.42952847, 0.4171784, 0.39931616, 0.39723602, 0.4925091, 0.38097438, 0.43372205, 0.37130034, 0.47692457, 0.45868933, 0.5466427, 0.5105982, 0.4668467, 0.4141953, 0.35623962, 0.4448853, 0.47568154, 0.42863622, 0.48320583, 0.4550801, 0.4237704, 0.4944469, 0.44257447, 0.3577773, 0.35302922, 0.3574617, 0.4206351, 0.43218815, 0.49657813, 0.49481228, 0.5224229, 0.4653174, 0.40787354, 0.5350264, 0.44005054, 0.525212, 0.5487382, 0.50569326, 0.47033504, 0.39067587, 0.38513798, 0.47026727, 0.43176374, 0.49422142, 0.47365874, 0.3826485, 0.48670003, 0.37896416, 0.43455184, 0.48214614, 0.4598231, 0.40317822, 0.3711933, 0.39539334, 0.33245084, 0.49328342, 0.45194915, 0.3571281, 0.51603496, 0.47817996, 0.44368926, 0.5013866, 0.4542029, 0.48952654, 0.52621293, 0.49459323, 0.5038077, 0.47935495, 0.4443138, 0.43925798, 0.4445702, 0.44749457, 0.47116682, 0.5553082, 0.5571765, 0.48604107, 0.47698668, 0.47113332, 0.44096547, 0.5122597, 0.4962135, 0.49451336, 0.48262516, 0.44308484, 0.47409052, 0.42520866, 0.466174, 0.5199746, 0.45218384, 0.5124676, 0.5421241, 0.47983682, 0.47295868, 0.47022748, 0.50361353, 0.2669768, 0.1943065, 0.17614485, 0.17559296, 0.16366006, 0.23459047, 0.34005105, 0.16161868, 0.14985153, 0.17047508, 0.23134458, 0.29921138, 0.2781876, 0.22269312, 0.25618565, 0.1821837, 0.18169427, 0.16263936, 0.1676356, 0.17201419, 0.205402, 0.16763683, 0.19382578, 0.20257649, 0.1725375, 0.20974813, 0.18283306, 0.3763808, 0.2935636, 0.1826639, 0.20457295, 0.266309, 0.27852654, 0.2674904, 0.25034136, 0.21656126, 0.21263558, 0.25553524, 0.35922194, 0.28042105, 0.2706404, 0.21023113, 0.24595782, 0.23903984, 0.23614699, 0.1693453, 0.16163158, 0.17553474, 0.22841434, 0.22591469, 0.16842757, 0.19056629, 0.16143878, 0.176603, 0.16573316, 0.18045384, 0.17029496, 0.17122689, 0.4840689, 0.50070536, 0.47628286, 0.4861676, 0.48281246, 0.4689432, 0.47618726, 0.4726745, 0.49753717, 0.5040856, 0.49268878, 0.51174974, 0.54943943, 0.5198044, 0.4814916, 0.502559, 0.49981767, 0.4903359, 0.4901821, 0.46919012, 0.47169963, 0.46470612, 0.4709993, 0.44513002, 0.4718116, 0.5094494, 0.5329059, 0.49212694, 0.4801414, 0.47664756, 0.51738626, 0.53308755, 0.5651255, 0.50560653, 0.51290286, 0.57671434, 0.54571754, 0.5716026, 0.500188, 0.51903373, 0.54302275, 0.53632414, 0.56124014, 0.49335617, 0.49221584, 0.48061115, 0.5214871, 0.3465924, 0.3010575, 0.52823764, 0.52266973, 0.41611835, 0.37097308, 0.4898158, 0.51073956, 0.52336264, 0.52153534, 0.5480801, 0.5406406, 0.49596816, 0.51336163, 0.475781, 0.5325866, 0.5354914, 0.5299572, 0.5105329, 0.5347016, 0.51777524, 0.50490427, 0.51007015, 0.53378916, 0.5537605, 0.51844734, 0.5273548, 0.5413823, 0.5192121, 0.5661583, 0.50927657, 0.5146854, 0.51152486, 0.5130369, 0.4816673, 0.4714288, 0.47090158, 0.53088254, 0.50376517, 0.46515888, 0.2038354, 0.21174598, 0.20213322, 0.1867574, 0.23325229, 0.22685407, 0.23037349, 0.2412086, 0.2084531, 0.22350472, 0.21804164, 0.23730053, 0.22142981, 0.229584, 0.24487038, 0.22483937, 0.24410342, 0.20996585, 0.20913213, 0.18595515, 0.23141062, 0.24460645, 0.23601188, 0.23138167, 0.216445, 0.22252636, 0.22078027, 0.22368571, 0.24085556, 0.22969347, 0.23945132, 0.26825717, 0.26706588, 0.48591864, 0.50080705, 0.4513901, 0.53610355, 0.52023596, 0.42440554, 0.5107612, 0.49511507, 0.48779973, 0.47594565, 0.45098123, 0.4596563, 0.4822592, 0.51767135, 0.4684692, 0.47692147, 0.47150725, 0.44520047, 0.44853762, 0.4886006, 0.47565025, 0.4552996, 0.4615028, 0.4633129, 0.4462108, 0.47366634, 0.18926357, 0.19635695, 0.17174521, 0.20510234, 0.21907032, 0.25564396, 0.24292336, 0.19663464, 0.18773793, 0.18955116, 0.19244258, 0.1931543, 0.19157967, 0.26660234, 0.19810103, 0.18866728, 0.18968062, 0.2011081, 0.16909686, 0.16083287, 0.22895345, 0.18899673, 0.18472423, 0.22362582, 0.19941008, 0.21345815, 0.25590456, 0.28920382, 0.234166, 0.22559632, 0.22320576, 0.23176572, 0.24054691, 0.25000829, 0.17100778, 0.19257665, 0.20172575, 0.18570496, 0.21077307, 0.19652404, 0.19847786, 0.17383893, 0.19034751, 0.27500388, 0.27703643, 0.23266727, 0.24650058, 0.22297935, 0.21207689, 0.19749315, 0.2214944, 0.23792955, 0.22598246, 0.2477344, 0.21146607, 0.23133549, 0.18072122, 0.28224894, 0.2058118, 0.2665051, 0.23298323, 0.19280654, 0.2380933, 0.2320027, 0.23135626, 0.20668, 0.23497525, 0.24123096, 0.26566076, 0.24451596, 0.21489124, 0.2547955, 0.26464635, 0.2990744, 0.2569166, 0.22461547, 0.23362301, 0.2762708, 0.23137954, 0.19841714, 0.29293585, 0.2501393, 0.27466738, 0.25886816, 0.22185566, 0.25410625, 0.21442404, 0.26291883, 0.26147187, 0.17475675, 0.26416525, 0.23675627, 0.2367339, 0.2293292, 0.21125053, 0.178628, 0.19534391, 0.2738388, 0.25700453, 0.37501732, 0.30776232, 0.34738111, 0.30188563, 0.36788896, 0.31365725, 0.3189187, 0.30009213, 0.3044506, 0.37610036, 0.19907293, 0.19333404, 0.20366718, 0.23323555, 0.27867982, 0.23735715, 0.27049133, 0.2875584, 0.28249177, 0.29363698, 0.16700514, 0.16448554, 0.17792708, 0.20283484, 0.18504275, 0.24673514, 0.33153307, 0.2945235, 0.27863076, 0.24073371, 0.25292772, 0.15080182, 0.21100554, 0.33555135, 0.22647102, 0.22627808, 0.20926669, 0.19507329, 0.22872028, 0.16996187, 0.16890752, 0.19260259, 0.17189668, 0.15913421, 0.16787189, 0.20732273, 0.19626315, 0.16389294, 0.19743104, 0.24010599, 0.25854224, 0.2571232, 0.2569534, 0.25547105, 0.25651652, 0.25460532, 0.26129112, 0.2549654]



cps = h5data[h5_video_id]['change_points'][...]
num_frames = h5data[h5_video_id]['n_frames'][()]
nfps = h5data[h5_video_id]['n_frame_per_seg'][...].tolist()
positions = h5data[h5_video_id]['picks'][...]
user_summary = h5data[h5_video_id]['user_summary'][...]

hacs_summary = generate_summary(hacs_score, cps, num_frames, nfps, positions)
original_vasnet_summary = generate_summary(original_vasnet_googlenet_score, cps, num_frames, nfps, positions)
gtscore_summary = generate_summary(h5data[h5_video_id]['gtscore'][...], cps, num_frames, nfps, positions)
# fm, _, _ = evaluate_summary(machine_summary, user_summary, 'avg')

# print(*gtscore_summary)
# print([i for i, v in enumerate(gtscore_summary) if v == 1.0])
# exit()
# quit()


html = '''<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  </head>
  <body>
    <h1>Hello, world!</h1>
    <table class="table table-striped">
        <tr>
            <th>Frame</th>
            <th>in-gtsummary</th>
            <th>in-hacs_summary</th>
            <th>in-vasnet_summary</th>
            <th>Scores</th>
        </tr>
    ----replacethis----
    </table>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
  </body>
</html>
'''

row = ''

image_size = 80

import base64
vid = cv2.VideoCapture(video_file_path)
import tqdm
with tqdm.tqdm(total = len(picks)) as pbar:
    while True:
        got, frame = vid.read()
        if not got:
            break
        else:
            frame_count += 1
        # print(frame_count, end = " " )

        if frame_count - 1 != picks[pick_index]: continue
        pbar.update(1)

        dim = (int(frame.shape[1] / frame.shape[0] * image_size),image_size)
        frame = cv2.resize(frame, dim)

        retval, buffer = cv2.imencode('.png', frame)
        frame_as_base64 = base64.b64encode(buffer)
        
        print(gtscore_summary[pick_index] )
        print(gtscore_summary[pick_index] == 1 )
        
        # print(frame_as_base64)
        row += f'''
<tr>
    <td><img src="data:image/png;base64,{frame_as_base64.decode()}" /></td>
    <td class="{"bg-success" if gtscore_summary[frame_count] == 1 else ""  }"></td>
    <td class="{"bg-danger" if hacs_summary[frame_count] == 1 else ""  }"></td>
    <td class="{"bg-secondary" if original_vasnet_summary[frame_count] == 1 else ""  }"></td>
    <td>
        <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="{round(h5data[h5_video_id]['gtscore'][...][pick_index]*100)}" aria-valuemin="0" aria-valuemax="100">
            <div class="progress-bar overflow-visible text-dark bg-success" style="width: {round(h5data[h5_video_id]['gtscore'][...][pick_index]*100)}%">{h5data[h5_video_id]['gtscore'][...][pick_index]}</div>
        </div>
        <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="{round(hacs_score[pick_index]*100)}" aria-valuemin="0" aria-valuemax="100">
            <div class="progress-bar overflow-visible text-dark bg-danger" style="width: {round(hacs_score[pick_index]*100)}%">{hacs_score[pick_index]}</div>
        </div>
        <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="{round(original_vasnet_googlenet_score[pick_index]*100)}" aria-valuemin="0" aria-valuemax="100">
            <div class="progress-bar overflow-visible text-dark bg-secondary" style="width: {round(original_vasnet_googlenet_score[pick_index]*100)}%">{original_vasnet_googlenet_score[pick_index]}</div>
        </div>
    </td>
</tr>'''
        pick_index += 1
        if pick_index == len(picks): break

        # break
        # if pick_index == 10: break

html = html.replace('----replacethis----', row)
with open('out.html', 'w') as f:
    f.write(html)